<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ÁõÆÂΩïÂàóË°®Ôºö{{.Path}}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .list { list-style: none; padding: 0; }
        .list li { 
            padding: 8px; 
            border-bottom: 1px solid #eee; 
            display: flex; 
            align-items: center;
            justify-content: space-between;
        }
        .list li:hover { background-color: #f5f5f5; }
        .dir { color: #2c3e50; font-weight: bold; }
        .file { color: #34495e; }
        .size { color: #7f8c8d; margin-left: 10px; }
        .time { color: #95a5a6; margin-left: 10px; }
        .empty-message { color: #666; text-align: center; padding: 20px; }
        .file-info { 
            display: flex;
            align-items: center;
            flex: 1;
        }
        .delete-btn {
            visibility: hidden;
            padding: 4px 8px;
            background-color: #ef4444;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: background-color 0.2s;
        }
        .list li:hover .delete-btn { 
            visibility: visible; 
        }
        .delete-btn:hover { 
            background-color: #dc2626; 
        }
        .delete-btn svg {
            width: 16px;
            height: 16px;
        }
        .breadcrumb {
            display: flex;
            align-items: center;
            padding: 8px 0;
            margin-bottom: 16px;
            border-bottom: 1px solid #eee;
        }
        .breadcrumb-item {
            display: flex;
            align-items: center;
        }
        .breadcrumb-item a {
            color: #3b82f6;
            text-decoration: none;
            padding: 4px 8px;
            border-radius: 4px;
        }
        .breadcrumb-item a:hover {
            background-color: #f0f9ff;
        }
        .breadcrumb-separator {
            color: #9ca3af;
            margin: 0 4px;
        }
        .breadcrumb-current {
            color: #4b5563;
            padding: 4px 8px;
        }
        .file-actions {
            display: flex;
            gap: 8px;
            align-items: center;
            white-space: nowrap;
        }
        .upload-btn {
            visibility: hidden;
            padding: 4px 8px;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            transition: background-color 0.2s;
            min-width: 90px;
            justify-content: center;
        }
        .list li:hover .upload-btn {
            visibility: visible;
        }
        .apk-upload {
            background-color: #3b82f6;
        }
        .apk-upload:hover {
            background-color: #2563eb;
        }
        .zip-upload {
            background-color: #10b981;
        }
        .zip-upload:hover {
            background-color: #059669;
        }
        .upload-btn svg {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }
    </style>
    <script>
        function deleteFile(path, event) {
            event.preventDefault();
            event.stopPropagation();
            
            if (!confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Êñá‰ª∂ÂêóÔºü')) {
                return;
            }

            fetch('/admin/browse/' + path, {
                method: 'DELETE'
            })
            .then(response => {
                if (response.ok) {
                    window.location.reload();
                } else {
                    alert('Âà†Èô§Â§±Ë¥•: ' + response.statusText);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Âà†Èô§Â§±Ë¥•: ' + error.message);
            });
        }
        function uploadToFTP(path, type, event) {
            event.preventDefault();
            event.stopPropagation();
            
            if (!confirm(`Á°ÆÂÆöË¶Å‰∏ä‰º†Ëøô‰∏™${type.toUpperCase()}Êñá‰ª∂ÂêóÔºü`)) {
                return;
            }

            fetch(`/admin/ftp/upload?file=${path}&type=${type}`, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('‰∏ä‰º†ÊàêÂäü');
                } else {
                    alert('‰∏ä‰º†Â§±Ë¥•: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('‰∏ä‰º†Â§±Ë¥•: ' + error.message);
            });
        }
    </script>
</head>
<body>
    <div class="breadcrumb">
        <div class="breadcrumb-item">
            <a href="/admin/browse/">Ê†πÁõÆÂΩï</a>
        </div>
        {{if ne .Path "."}}
            {{$paths := .BreadcrumbPaths}}
            {{range $index, $element := $paths}}
                <span class="breadcrumb-separator">/</span>
                <div class="breadcrumb-item">
                    {{if eq $index (len $paths)}}
                        <span class="breadcrumb-current">{{$element.Name}}</span>
                    {{else}}
                        <a href="/admin/browse/{{$element.Path}}">{{$element.Name}}</a>
                    {{end}}
                </div>
            {{end}}
        {{end}}
    </div>
    <h1>Directory listing for {{.Path}}</h1>
    {{if .Files}}
    <ul class="list">
        {{if ne .Path "."}}
        <li>
            <div class="file-info">
                <a href="/admin/browse/{{.ParentPath}}" class="dir">üìÅ ..</a>
            </div>
        </li>
        {{end}}
        {{range .Files}}
        <li>
            <div class="file-info">
                {{if .IsDir}}
                <a href="/admin/browse/{{.Path}}" class="dir">üìÅ {{.Name}}/</a>
                {{else}}
                <a href="/admin/browse/{{.Path}}" class="file">üìÑ {{.Name}}</a>
                <span class="size">{{.FormatSize}}</span>
                {{end}}
                <span class="time">{{.ModTime}}</span>
            </div>
            {{if not .IsDir}}
            <div class="file-actions">
                <button onclick="deleteFile('{{.Path}}', event)" class="delete-btn">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                        </path>
                    </svg>
                    Âà†Èô§
                </button>
                {{if eq .FileType "apk"}}
                <button onclick="uploadToFTP('{{.Path}}', 'apk', event)" class="upload-btn apk-upload">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                    </svg>
                    ‰∏ä‰º†APK
                </button>
                {{end}}
                {{if eq .FileType "zip"}}
                <button onclick="uploadToFTP('{{.Path}}', 'zip', event)" class="upload-btn zip-upload">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                    </svg>
                    ‰∏ä‰º†ZIP
                </button>
                {{end}}
            </div>
            {{end}}
        </li>
        {{end}}
    </ul>
    {{else}}
    <p class="empty-message">Ê≠§Êñá‰ª∂Â§π‰∏∫Á©∫</p>
    {{end}}
</body>
</html> 